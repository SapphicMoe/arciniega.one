---
import Layout from '@layouts/Page.astro';

import BlogCard from '@components/blog/BlogCard.astro';

import { Icon } from 'astro-icon/components';
import type { CollectionEntry } from 'astro:content';

interface Props {
  filterTag?: string;
  articles: CollectionEntry<'articles'>[];
}

const { filterTag, articles } = Astro.props;
---

<Layout
  description="A personal blog, comprising of whatever stuff I find interesting to post."
  pageTitle="Articles"
  title="Articles | Chloe Arciniega"
>
  <header class="flex flex-col gap-3 pb-3">
    <h1 class="title">Articles</h1>
    <p>A personal blog, comprising of whatever stuff I find interesting to post.</p>

    <section class="flex">
      <Icon size={25} class="mr-1" name="mdi:rss" />
      <a title="Subscribe to my RSS feed" href="/rss.xml"> Subscribe to RSS</a>
    </section>

    {
      filterTag && (
        <div class="flex">
          <Icon size={25} class="mr-1" name="mdi:information" />
          <p>
            Showing articles with the tag <span class="font-bold">{filterTag}</span>.
          </p>
        </div>
      )
    }
  </header>

  <hr class="text-ctp-mauve dark:text-ctp-pink" />

  {
    articles
      .sort((a, b) => new Date(b.data.created).valueOf() - new Date(a.data.created).valueOf())
      .map(async (article) => {
        const { remarkPluginFrontmatter: frontmatter } = await article.render();
        return <BlogCard data={article.data} slug={article.slug} minutesRead={frontmatter.minutesRead} />;
      })
  }

  <slot />
</Layout>
